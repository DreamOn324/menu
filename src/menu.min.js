(function(b) {
	b.fn.menu = function(d) {
		function l(a, b) {
			c.css({
				color: a,
				backgroundColor: b
			});
			h.css({
				color: a,
				backgroundColor: b
			})
		}

		function m(a, d) {
			var f;
			g.find("a").hover(function() {
				var c = b(this);
				c.css("color");
				f = c.css("backgroundColor");
				c.css({
					color: a,
					backgroundColor: d
				})
			}, function() {
				b(this).css({
					color: void 0,
					backgroundColor: f
				})
			})
		}

		function n() {
			c.hover(function() {
				b(this).css({
					color: a.firstHoverFontColor,
					backgroundColor: a.firstHoverBgColor
				})
			}, function() {
				b(this).css({
					color: a.firstFontColor,
					backgroundColor: a.firstBgColor
				})
			});
			h.hover(function() {
				var e = b(this);
				e.css({
					color: a.secondHoverFontColor,
					backgroundColor: a.secondHoverBgColor
				});
				e.parents("ul").first().prev().css({
					color: a.firstHoverFontColor,
					backgroundColor: a.firstHoverBgColor
				})
			}, function() {
				var e = b(this);
				e.css({
					color: a.secondFontColor,
					backgroundColor: a.secondBgColor
				});
				e.parents("ul").first().prev().css({
					color: a.firstFontColor,
					backgroundColor: a.firstBgColor
				})
			})
		}
		var g = this.children("ul"),
			c = g.children("li").children("a"),
			h = g.find("ul").find("a"),
			k = g.find("ul").length,
			a = b.extend({}, {
				firstFontSize: "16px",
				firstFontColor: "#fff",
				firstBgColor: "#0E90D2",
				firstHoverFontColor: "#fff",
				firstHoverBgColor: "#0C79B1",
				secondFontSize: "16px",
				secondFontColor: "#fff",
				secondBgColor: "#0E90D2",
				secondHoverFontColor: "#fff",
				secondHoverBgColor: "#0C79B1",
				itemWidth: 20,
				itemMargin: 1,
				theme: "blue"
			}, d);
		d = !!navigator.userAgent.match(/AppleWebKit.*Mobile.*/);
		switch (a.theme) {
			case "blue":
				l("#fff", "#0E90D2");
				!d && m("#fff", "#0C79B1");
				break;
			case "dark":
				l("#9D9D9D", "#1F1F1F"), !d && m("#fff", "#000")
		}
		c.css({
			fontSize: a.firstFontSize,
			color: a.firstFontColor,
			backgroundColor: a.firstBgColor
		}).parent("li").each(function(e, d) {
			var c = b(this);
			c.width(c.width() + a.itemWidth)
		}).not(g.children("li").first()).css({
			marginLeft: a.itemMargin + "px"
		});
		k && (h.css({
			fontSize: a.secondFontSize,
			color: a.secondFontColor,
			backgroundColor: a.secondBgColor
		}), b.each(c, function(e, d) {
			var f = b(this).next("ul");
			f.width() + a.itemWidth < c.width() ? f.width(c.width()) : f.width(f.width() + a.itemWidth)
		}));
		if (d) {
			d = "hover";
			try {
				FastClick && (FastClick.attach(document.body), d = "click")
			} catch (e) {
				console.log("fastclick.js is not found.You are still using 'click'")
			}
			k && ("hover" == d ? n() : "click" == d && (c.on("click", function() {
				var a = b(this).next("ul");
				a.is(":hidden") ? a.show() : a.is(":visible") && a.hide()
			}), h.on("click", function() {
				var a = b(this).parent().parent();
				a.is(":hidden") ? a.show() : a.is(":visible") && a.hide()
			})))
		} else k && n();
		return this
	}
})(jQuery);